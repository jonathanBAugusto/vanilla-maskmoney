!function($){"use strict";$.browser||($.browser={},$.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),$.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),$.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),$.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()),$.browser.device=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()));var defaultOptions={prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:2,allowZero:!1,allowNegative:!1,doubleClickSelection:!0,allowEmpty:!1,bringCaretAtEndOnFocus:!0},methods={destroy:function(){return $(this).unbind(".maskMoney"),$.browser.msie&&(this.onpaste=null),this},applyMask:function(value){var $input,settings;return maskValue(value,$(this).data("settings"))},mask:function(value){return this.each((function(){var $this=$(this);return"number"==typeof value&&$this.val(value),$this.trigger("mask")}))},unmasked:function(){return this.map((function(){var value=$(this).val()||"0",isNegative=-1!==value.indexOf("-"),decimalPart;return $(value.split(/\D/).reverse()).each((function(index,element){if(element)return decimalPart=element,!1})),value=(value=value.replace(/\D/g,"")).replace(new RegExp(decimalPart+"$"),"."+decimalPart),isNegative&&(value="-"+value),parseFloat(value)}))},unmaskedWithOptions:function(){return this.map((function(){var value=$(this).val()||"0",settings=$(this).data("settings")||defaultOptions,regExp=new RegExp(settings.thousandsForUnmasked||settings.thousands,"g");return value=value.replace(regExp,""),parseFloat(value)}))},init:function(parameters){return parameters=$.extend($.extend({},defaultOptions),parameters),this.each((function(){var $input=$(this),settings,onFocusValue;function getInputSelection(){var el=$input.get(0),start=0,end=0,normalizedValue,range,textInputRange,len,endRange;return"number"==typeof el.selectionStart&&"number"==typeof el.selectionEnd?(start=el.selectionStart,end=el.selectionEnd):(range=document.selection.createRange())&&range.parentElement()===el&&(len=el.value.length,normalizedValue=el.value.replace(/\r\n/g,"\n"),(textInputRange=el.createTextRange()).moveToBookmark(range.getBookmark()),(endRange=el.createTextRange()).collapse(!1),textInputRange.compareEndPoints("StartToEnd",endRange)>-1?start=end=len:(start=-textInputRange.moveStart("character",-len),start+=normalizedValue.slice(0,start).split("\n").length-1,textInputRange.compareEndPoints("EndToEnd",endRange)>-1?end=len:(end=-textInputRange.moveEnd("character",-len),end+=normalizedValue.slice(0,end).split("\n").length-1))),{start:start,end:end}}function canInputMoreNumbers(){var haventReachedMaxLength=!($input.val().length>=$input.attr("maxlength")&&$input.attr("maxlength")>=0),selection=getInputSelection(),start=selection.start,end=selection.end,haveNumberSelected=!(selection.start===selection.end||!$input.val().substring(start,end).match(/\d/)),startWithZero="0"===$input.val().substring(0,1);return haventReachedMaxLength||haveNumberSelected||startWithZero}function setCursorPosition(pos){settings.formatOnBlur||$input.each((function(index,elem){if(elem.setSelectionRange)elem.focus(),elem.setSelectionRange(pos,pos);else if(elem.createTextRange){var range=elem.createTextRange();range.collapse(!0),range.moveEnd("character",pos),range.moveStart("character",pos),range.select()}}))}function maskAndPosition(startPos){var originalLen=$input.val().length,newLen;$input.val(maskValue($input.val(),settings)),newLen=$input.val().length,settings.reverse||(startPos-=originalLen-newLen),setCursorPosition(startPos)}function mask(){var value=$input.val();if(!settings.allowEmpty||""!==value){value.match(/[^0-9,.]/g)&&(value=value.replace(/[^0-9,.-]/g,""));var isNumber,decimalPointIndex=!isNaN(value)?value.indexOf("."):value.indexOf(settings.decimal);if(settings.precision>0)if(decimalPointIndex<0)value+=settings.decimal+new Array(settings.precision+1).join(0);else{var integerPart=value.slice(0,decimalPointIndex),decimalPart=value.slice(decimalPointIndex+1);value=integerPart+settings.decimal+decimalPart+new Array(settings.precision+1-decimalPart.length).join(0)}else decimalPointIndex>0&&(value=value.slice(0,decimalPointIndex));$input.val(maskValue(value,settings))}}function changeSign(){var inputValue=$input.val();return settings.allowNegative?""!==inputValue&&"-"===inputValue.charAt(0)?inputValue.replace("-",""):"-"+inputValue:inputValue}function preventDefault(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function fixMobile(){$.browser.device&&$input.attr("type","tel")}function keypressEvent(e){var key=(e=e||window.event).which||e.charCode||e.keyCode,decimalKeyCode=settings.decimal.charCodeAt(0);return void 0!==key&&(!(key<48||key>57)||key===decimalKeyCode&&settings.reverse?!!canInputMoreNumbers()&&((key!==decimalKeyCode||!shouldPreventDecimalKey())&&(!!settings.formatOnBlur||(preventDefault(e),applyMask(e),!1))):handleAllKeysExceptNumericalDigits(key,e))}function shouldPreventDecimalKey(){return!isAllTextSelected()&&alreadyContainsDecimal()}function isAllTextSelected(){var length=$input.val().length,selection=getInputSelection();return 0===selection.start&&selection.end===length}function alreadyContainsDecimal(){return $input.val().indexOf(settings.decimal)>-1}function applyMask(e){var key=(e=e||window.event).which||e.charCode||e.keyCode,keyPressedChar="",selection,startPos,endPos,value;key>=48&&key<=57&&(keyPressedChar=String.fromCharCode(key)),startPos=(selection=getInputSelection()).start,endPos=selection.end,value=$input.val(),$input.val(value.substring(0,startPos)+keyPressedChar+value.substring(endPos,value.length)),maskAndPosition(startPos+1)}function handleAllKeysExceptNumericalDigits(key,e){return 45===key?($input.val(changeSign()),!1):43===key?($input.val($input.val().replace("-","")),!1):13===key||9===key||(!(!$.browser.mozilla||37!==key&&39!==key||0!==e.charCode)||(preventDefault(e),!0))}function keydownEvent(e){var key=(e=e||window.event).which||e.charCode||e.keyCode,selection,startPos,endPos,value,lastNumber;return void 0!==key&&(startPos=(selection=getInputSelection()).start,endPos=selection.end,8!==key&&46!==key&&63272!==key||(preventDefault(e),value=$input.val(),startPos===endPos&&(8===key?""===settings.suffix?startPos-=1:(lastNumber=value.split("").reverse().join("").search(/\d/),endPos=(startPos=value.length-lastNumber-1)+1):endPos+=1),$input.val(value.substring(0,startPos)+value.substring(endPos,value.length)),maskAndPosition(startPos),!1))}function focusEvent(){onFocusValue=$input.val(),mask();var input=$input.get(0),textRange;settings.selectAllOnFocus?input.select():input.createTextRange&&settings.bringCaretAtEndOnFocus&&((textRange=input.createTextRange()).collapse(!1),textRange.select())}function cutPasteEvent(){setTimeout((function(){mask()}),0)}function getDefaultMask(){var n;return(parseFloat("0")/Math.pow(10,settings.precision)).toFixed(settings.precision).replace(new RegExp("\\.","g"),settings.decimal)}function blurEvent(e){if($.browser.msie&&keypressEvent(e),settings.formatOnBlur&&$input.val()!==onFocusValue&&applyMask(e),""===$input.val()&&settings.allowEmpty)$input.val("");else if(""===$input.val()||$input.val()===setSymbol(getDefaultMask(),settings))settings.allowZero?settings.affixesStay?$input.val(setSymbol(getDefaultMask(),settings)):$input.val(getDefaultMask()):$input.val("");else if(!settings.affixesStay){var newValue=$input.val().replace(settings.prefix,"").replace(settings.suffix,"");$input.val(newValue)}$input.val()!==onFocusValue&&$input.change()}function clickEvent(){var input=$input.get(0),length;settings.selectAllOnFocus||(input.setSelectionRange&&settings.bringCaretAtEndOnFocus?(length=$input.val().length,input.setSelectionRange(length,length)):$input.val($input.val()))}function doubleClickEvent(){var input=$input.get(0),start,length;input.setSelectionRange&&settings.bringCaretAtEndOnFocus?(length=$input.val().length,start=settings.doubleClickSelection?0:length,input.setSelectionRange(start,length)):$input.val($input.val())}settings=$.extend({},parameters),settings=$.extend(settings,$input.data()),$input.data("settings",settings),fixMobile(),$input.unbind(".maskMoney"),$input.bind("keypress.maskMoney",keypressEvent),$input.bind("keydown.maskMoney",keydownEvent),$input.bind("blur.maskMoney",blurEvent),$input.bind("focus.maskMoney",focusEvent),$input.bind("click.maskMoney",clickEvent),$input.bind("dblclick.maskMoney",doubleClickEvent),$input.bind("cut.maskMoney",cutPasteEvent),$input.bind("paste.maskMoney",cutPasteEvent),$input.bind("mask.maskMoney",mask)}))}};function setSymbol(value,settings){var operator="";return value.indexOf("-")>-1&&(value=value.replace("-",""),operator="-"),value.indexOf(settings.prefix)>-1&&(value=value.replace(settings.prefix,"")),value.indexOf(settings.suffix)>-1&&(value=value.replace(settings.suffix,"")),operator+settings.prefix+value+settings.suffix}function maskValue(value,settings){return settings.allowEmpty&&""===value?"":settings.reverse?maskValueReverse(value,settings):maskValueStandard(value,settings)}function maskValueStandard(value,settings){var negative=value.indexOf("-")>-1&&settings.allowNegative?"-":"",onlyNumbers=value.replace(/[^0-9]/g,""),integerPart=onlyNumbers.slice(0,onlyNumbers.length-settings.precision),newValue,decimalPart,leadingZeros;if(newValue=buildIntegerPart(integerPart,negative,settings),settings.precision>0){if(!isNaN(value)&&value.indexOf(".")){var precision=value.substr(value.indexOf(".")+1);newValue=buildIntegerPart(integerPart=(onlyNumbers+=new Array(settings.precision+1-precision.length).join(0)).slice(0,onlyNumbers.length-settings.precision),negative,settings)}decimalPart=onlyNumbers.slice(onlyNumbers.length-settings.precision),leadingZeros=new Array(settings.precision+1-decimalPart.length).join(0),newValue+=settings.decimal+leadingZeros+decimalPart}return setSymbol(newValue,settings)}function maskValueReverse(value,settings){var negative=value.indexOf("-")>-1&&settings.allowNegative?"-":"",valueWithoutSymbol=value.replace(settings.prefix,"").replace(settings.suffix,""),integerPart=valueWithoutSymbol.split(settings.decimal)[0],newValue,decimalPart="";if(""===integerPart&&(integerPart="0"),newValue=buildIntegerPart(integerPart,negative,settings),settings.precision>0){var arr=valueWithoutSymbol.split(settings.decimal);arr.length>1&&(decimalPart=arr[1]),newValue+=settings.decimal+decimalPart;var rounded,roundedDecimalPart=Number.parseFloat(integerPart+"."+decimalPart).toFixed(settings.precision).toString().split(settings.decimal)[1];newValue=newValue.split(settings.decimal)[0]+"."+roundedDecimalPart}return setSymbol(newValue,settings)}function buildIntegerPart(integerPart,negative,settings){return""===(integerPart=(integerPart=integerPart.replace(/^0*/g,"")).replace(/\B(?=(\d{3})+(?!\d))/g,settings.thousands))&&(integerPart="0"),negative+integerPart}$.fn.maskMoney=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist on jQuery.maskMoney"):methods.init.apply(this,arguments)}}(window.jQuery||window.Zepto);